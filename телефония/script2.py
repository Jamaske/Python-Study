
dialog = [
[3100, 4650, 1],
[4860, 6170, 1],

[7580, 11690, 0],
[12540, 13050, 0],

[14460, 14890, 1],
[15100, 15690, 1],

[16620, 17770, 0],

[20780, 21850, 1],
[22060, 24435, 1],

[24435, 28090, 0],

[28940, 30570, 1],
[30780, 31130, 1],

[31820, 34090, 0],

[34460, 36330, 1],

[36860, 38170, 0],

[38460, 38810, 1],
[39020, 39530, 1],
[41180, 41980, 1]
]

statements = [
{'start': 5.155, 'end': 8.276, 'text': ' Администратор Алена, здравствуйте, чем могу помочь вам?', 'words': [{'word': 'Администратор', 'start': 5.155, 'end': 7.275, 'score': 0.325}, {'word': 'Алена,', 'start': 7.295, 'end': 7.395, 'score': 0.0}, {'word': 'здравствуйте,', 'start': 7.415, 'end': 7.716, 'score': 0.098}, {'word': 'чем', 'start': 7.736, 'end': 7.796, 'score': 0.036}, {'word': 'могу', 'start': 7.816, 'end': 7.896, 'score': 0.0}, {'word': 'помочь', 'start': 7.916, 'end': 8.176, 'score': 0.486}, {'word': 'вам?', 'start': 8.196, 'end': 8.276, 'score': 0.293}]},
{'start': 8.296, 'end': 12.357, 'text': 'Добрый вечер, подскажите, вы записаны к офтермологу на 5 часов, по-моему?', 'words': [{'word': 'Добрый', 'start': 8.296, 'end': 8.436, 'score': 0.084}, {'word': 'вечер,', 'start': 8.456, 'end': 8.596, 'score': 0.386}, {'word': 'подскажите,', 'start': 8.616, 'end': 8.956, 'score': 0.344}, {'word': 'вы', 'start': 8.976, 'end': 9.016, 'score': 0.274}, {'word': 'записаны', 'start': 9.036, 'end': 9.556, 'score': 0.837}, {'word': 'к', 'start': 9.656, 'end': 9.956, 'score': 0.911}, {'word': 'офтермологу', 'start': 9.996, 'end': 10.636, 'score': 0.88}, {'word': 'на', 'start': 10.696, 'end': 11.016, 'score': 1.0}, {'word': '5'}, {'word': 'часов,', 'start': 11.256, 'end': 11.556, 'score': 0.928}, {'word': 'по-моему?', 'start': 11.596, 'end': 12.357, 'score': 0.946}]},
{'start': 12.377, 'end': 16.357, 'text': 'К офтермологу записаны?', 'words': [{'word': 'К', 'start': 12.377, 'end': 12.397, 'score': 0.004}, {'word': 'офтермологу', 'start': 12.417, 'end': 12.817, 'score': 0.316}, {'word': 'записаны?', 'start': 12.837, 'end': 16.357, 'score': 0.563}]},
{'start': 16.417, 'end': 21.619, 'text': 'Да-да-да, Куница.', 'words': [{'word': 'Да-да-да,', 'start': 16.417, 'end': 17.158, 'score': 0.664}, {'word': 'Куница.', 'start': 17.218, 'end': 21.619, 'score': 0.92}]},
{'start': 21.639, 'end': 27.08, 'text': 'Очень, простите, пожалуйста, плохо слышно, тут ребенок у нас спящий.', 'words': [{'word': 'Очень,', 'start': 21.639, 'end': 24.019, 'score': 0.831}, {'word': 'простите,', 'start': 24.039, 'end': 24.479, 'score': 0.333}, {'word': 'пожалуйста,', 'start': 24.499, 'end': 24.899, 'score': 0.284}, {'word': 'плохо', 'start': 24.939, 'end': 25.219, 'score': 0.686}, {'word': 'слышно,', 'start': 25.239, 'end': 25.619, 'score': 0.623}, {'word': 'тут', 'start': 25.879, 'end': 25.94, 'score': 0.002}, {'word': 'ребенок', 'start': 26.0, 'end': 26.22, 'score': 0.299}, {'word': 'у', 'start': 26.24, 'end': 26.26, 'score': 0.0}, {'word': 'нас', 'start': 26.3, 'end': 26.6, 'score': 0.735}, {'word': 'спящий.', 'start': 26.66, 'end': 27.08, 'score': 0.527}]},
{'start': 27.1, 'end': 28.16, 'text': 'К офтермологу, да, на 18-16, на ноль, по-моему.', 'words': [{'word': 'К', 'start': 27.1, 'end': 27.12, 'score': 0.0}, {'word': 'офтермологу,', 'start': 27.14, 'end': 27.42, 'score': 0.182}, {'word': 'да,', 'start': 27.44, 'end': 27.52, 'score': 0.35}, {'word': 'на', 'start': 27.54, 'end': 27.62, 'score': 0.75}, {'word': '18-16,', 'start': 27.64, 'end': 27.66, 'score': 0.0}, {'word': 'на', 'start': 27.7, 'end': 27.76, 'score': 0.772}, {'word': 'ноль,', 'start': 27.78, 'end': 27.86, 'score': 0.128}, {'word': 'по-моему.', 'start': 27.88, 'end': 28.16, 'score': 0.329}]},

{'start': 31.877, 'end': 32.918, 'text': ' Я хочу пока отменить.', 'words': [{'word': 'Я', 'start': 31.877, 'end': 31.937, 'score': 0.67}, {'word': 'хочу', 'start': 31.977, 'end': 32.157, 'score': 0.935}, {'word': 'пока', 'start': 32.197, 'end': 32.458, 'score': 0.961}, {'word': 'отменить.', 'start': 32.478, 'end': 32.918, 'score': 0.556}]},
{'start': 32.938, 'end': 33.939, 'text': 'Я сегодня уже сходил.', 'words': [{'word': 'Я', 'start': 32.938, 'end': 32.958, 'score': 0.771}, {'word': 'сегодня', 'start': 33.219, 'end': 33.459, 'score': 0.699}, {'word': 'уже', 'start': 33.479, 'end': 33.579, 'score': 0.726}, {'word': 'сходил.', 'start': 33.619, 'end': 33.939, 'score': 0.802}]},
{'start': 33.959, 'end': 34.86, 'text': 'Отмените.', 'words': [{'word': 'Отмените.', 'start': 33.959, 'end': 34.86, 'score': 0.641}]},
{'start': 34.92, 'end': 36.842, 'text': 'Чугаев, да?', 'words': [{'word': 'Чугаев,', 'start': 34.92, 'end': 36.022, 'score': 0.584}, {'word': 'да?', 'start': 36.062, 'end': 36.842, 'score': 0.985}]},

{'start': 36.903, 'end': 37.383, 'text': 'Да, да, да.', 'words': [{'word': 'Да,', 'start': 36.903, 'end': 37.023, 'score': 0.898}, {'word': 'да,', 'start': 37.063, 'end': 37.103, 'score': 0.056}, {'word': 'да.', 'start': 37.143, 'end': 37.383, 'score': 0.871}]},
{'start': 37.403, 'end': 38.244, 'text': 'Отмените, пожалуйста.', 'words': [{'word': 'Отмените,', 'start': 37.403, 'end': 37.703, 'score': 0.376}, {'word': 'пожалуйста.', 'start': 37.743, 'end': 38.244, 'score': 0.382}]},

{'start': 38.264, 'end': 38.704, 'text': 'Ага, все хорошо.', 'words': [{'word': 'Ага,', 'start': 38.264, 'end': 38.344, 'score': 0.163}, {'word': 'все', 'start': 38.364, 'end': 38.424, 'score': 0.0}, {'word': 'хорошо.', 'start': 38.444, 'end': 38.704, 'score': 0.397}]},

{'start': 38.724, 'end': 38.905, 'text': 'Спасибо.', 'words': [{'word': 'Спасибо.', 'start': 38.724, 'end': 38.905, 'score': 0.145}]},

{'start': 38.925, 'end': 39.365, 'text': 'Пожалуйста, да.', 'words': [{'word': 'Пожалуйста,', 'start': 38.925, 'end': 39.305, 'score': 0.323}, {'word': 'да.', 'start': 39.325, 'end': 39.365, 'score': 0.002}]}
]




#можно подкручивать коэффициенты, чтобы получше совпадение было
#но энивей плохо идёт
offset = -0.5
# Phrase Separator Coefficient
PSC = 0.5
# Statement Reference Coefficient
SRC = 0.5


i = 0
j = 0
k = 0
res = []
while i < len(dialog) and j < len(statements):
    phrase_owner = dialog[i][2]
    while (i:= i + 1) < len(dialog) and dialog[i][2] == phrase_owner:
        pass
    if i < len(dialog): phrase_separator = ( (1-PSC)*dialog[i-1][1] + PSC*dialog[i][0]) / 1000 
    else: phrase_separator = 10**10 # +inf

    res.append([['пчел0', 'пчел1'][phrase_owner],[]])

    while j < len(statements):
        statement = statements[j]
        ref_point = ((1-SRC)*statement['start'] + SRC*statement['end']) + offset
        if phrase_separator < ref_point:
            break
        res[k][-1].append(statement['text'])
        j += 1
    
    res[k][-1] = ' '.join(res[k][-1])
    k += 1
for ans in res: print(ans)